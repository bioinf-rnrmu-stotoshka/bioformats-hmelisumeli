<!DOCTYPE html>

<html lang="ru" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>code_scripts.vcf_reader3 &#8212; документация Infa_project 0.1</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=490fdf2e"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=5b699b7f"></script>
    <link rel="index" title="Алфавитный указатель" href="../../genindex.html" />
    <link rel="search" title="Поиск" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Исходный код code_scripts.vcf_reader3</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Модуль для анализа VCF файлов (Variant Call Format) - формата хранения генетических вариантов.</span>
<span class="sd">Предоставляет функциональность для чтения, парсинга и статистического анализа</span>
<span class="sd">данных генетических вариаций в VCF формате.</span>

<span class="sd">Основные компоненты:</span>
<span class="sd">- Класс Vcf_reader: основной класс для работы с VCF файлами</span>
<span class="sd">- Методы для извлечения различных типов заголовков</span>
<span class="sd">- Функции для статистического анализа вариантов</span>
<span class="sd">- Методы для работы с геномными регионами</span>

<span class="sd">Входные данные: VCF файлы (.vcf, .vcf.gz)</span>
<span class="sd">Выходные данные: статистика, таблицы с данными вариантов, информация по регионам</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>


<div class="viewcode-block" id="Vcf_reader">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader">[документация]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Vcf_reader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    КЛАСС VCF_READER - АНАЛИЗ VCF ФАЙЛОВ</span>
<span class="sd">    ====================================</span>
<span class="sd">    Основной класс для работы с VCF файлами формата.</span>

<span class="sd">    Логика работы класса:</span>
<span class="sd">    - Чтение и парсинг VCF файла с поддержкой различных кодировок</span>
<span class="sd">    - Извлечение структурированной информации из заголовков</span>
<span class="sd">    - Статистический анализ распределения генетических вариантов</span>
<span class="sd">    - Работа с геномными регионами и вычисление покрытия</span>

<span class="sd">    Атрибуты:</span>
<span class="sd">    - path: строка, путь к VCF файлу для анализа</span>

<span class="sd">    Методы:</span>
<span class="sd">    - _lines: служебный метод для построчного чтения файла</span>
<span class="sd">    - title: извлечение всех заголовочных строк</span>
<span class="sd">    - info: извлечение INFO заголовков</span>
<span class="sd">    - filter: извлечение FILTER заголовков</span>
<span class="sd">    - format: извлечение FORMAT заголовков</span>
<span class="sd">    - alt: извлечение ALT заголовков</span>
<span class="sd">    - contig: извлечение CONTIG заголовков</span>
<span class="sd">    - count: подсчет общего количества вариантов</span>
<span class="sd">    - stats: статистика по регионам с глубиной покрытия</span>
<span class="sd">    - varregion: поиск вариантов в заданном геномном регионе</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        КОНСТРУКТОР КЛАССА</span>
<span class="sd">        ==================</span>
<span class="sd">        Инициализирует анализатор VCF файлов.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Сохраняет путь к файлу для последующего использования</span>
<span class="sd">        - Подготавливает объект для методов чтения и анализа</span>

<span class="sd">        Входные данные:</span>
<span class="sd">        - path: строка, абсолютный или относительный путь к VCF файлу</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Инициализированный объект Vcf_reader</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        СЛУЖЕБНЫЙ МЕТОД ДЛЯ ПОСТРОЧНОГО ЧТЕНИЯ</span>
<span class="sd">        ======================================</span>
<span class="sd">        Генератор для построчного чтения VCF файла.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        1. Открывает файл с указанной кодировкой (latin-1 для совместимости)</span>
<span class="sd">        2. Итерируется по всем строкам файла</span>
<span class="sd">        3. Удаляет пробельные символы в начале и конце каждой строки</span>
<span class="sd">        4. Возвращает строки через yield для эффективной обработки</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор, возвращающий очищенные строки файла</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<div class="viewcode-block" id="Vcf_reader.title">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.title">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ИЗВЛЕЧЕНИЕ ВСЕХ ЗАГОЛОВОЧНЫХ СТРОК</span>
<span class="sd">        ==================================</span>
<span class="sd">        Возвращает все строки заголовков VCF файла.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Фильтрует строки, начинающиеся с &#39;##&#39; (мета-информация)</span>
<span class="sd">        - Включает все типы заголовков: INFO, FILTER, FORMAT, ALT, contig</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор строк полного заголовка VCF файла</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;##&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Vcf_reader.info">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.info">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ИЗВЛЕЧЕНИЕ INFO ЗАГОЛОВКОВ</span>
<span class="sd">        ==========================</span>
<span class="sd">        Возвращает заголовки, описывающие поля в колонке INFO.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Фильтрует строки, начинающиеся с &#39;##INFO&#39;</span>
<span class="sd">        - Содержит описание дополнительных полей информации о вариантах</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор строк с описанием INFO полей</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;##INFO&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Vcf_reader.filter">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.filter">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ИЗВЛЕЧЕНИЕ FILTER ЗАГОЛОВКОВ</span>
<span class="sd">        ============================</span>
<span class="sd">        Возвращает заголовки, описывающие критерии фильтрации.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Фильтрует строки, начинающиеся с &#39;##FILTER&#39;</span>
<span class="sd">        - Содержит описание фильтров, примененных к вариантам</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор строк с описанием FILTER критериев</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;##FILTER&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Vcf_reader.format">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.format">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ИЗВЛЕЧЕНИЕ FORMAT ЗАГОЛОВКОВ</span>
<span class="sd">        ============================</span>
<span class="sd">        Возвращает заголовки, описывающие формат полей для образцов.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Фильтрует строки, начинающиеся с &#39;##FORMAT&#39;</span>
<span class="sd">        - Определяет, какие параметры могут быть указаны для каждого образца</span>
<span class="sd">        - Описывает структуру данных в колонках образцов</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор строк с описанием FORMAT полей</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;##FORMAT&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Vcf_reader.alt">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.alt">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">alt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ИЗВЛЕЧЕНИЕ ALT ЗАГОЛОВКОВ</span>
<span class="sd">        =========================</span>
<span class="sd">        Возвращает заголовки, описывающие альтернативные типы аллелей.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Фильтрует строки, начинающиеся с &#39;##ALT&#39;</span>
<span class="sd">        - Содержит описание нестандартных типов аллелей (структурные варианты)</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор строк с описанием ALT типов</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;##ALT&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Vcf_reader.contig">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.contig">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ИЗВЛЕЧЕНИЕ CONTIG ЗАГОЛОВКОВ</span>
<span class="sd">        ============================</span>
<span class="sd">        Возвращает заголовки, содержащие информацию о хромосомах.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        - Фильтрует строки, начинающиеся с &#39;##contig&#39;</span>
<span class="sd">        - Содержит мета-информацию о референсных последовательностях</span>
<span class="sd">        - Может включать длину хромосом, сборки и другую информацию</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - Генератор строк с описанием CONTIG (хромосом)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;##contig&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Vcf_reader.count">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.count">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ПОДСЧЕТ ОБЩЕГО КОЛИЧЕСТВА ВАРИАНТОВ</span>
<span class="sd">        ===================================</span>
<span class="sd">        Вычисляет общее количество генетических вариантов в VCF файле.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        1. Итерируется по всем строкам файла</span>
<span class="sd">        2. Игнорирует строки заголовков (начинающиеся с &#39;#&#39;)</span>
<span class="sd">        3. Подсчитывает строки с данными вариантов</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - int: общее количество вариантов в файле</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">count</span></div>


<div class="viewcode-block" id="Vcf_reader.stats">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.stats">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        СТАТИСТИКА ПО РЕГИОНАМ С ГЛУБИНОЙ ПОКРЫТИЯ</span>
<span class="sd">        ==========================================</span>
<span class="sd">        Анализирует распределение вариантов по геномным регионам.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        1. Разбивает геном на регионы фиксированного размера</span>
<span class="sd">        2. Для каждого варианта определяет принадлежность к региону</span>
<span class="sd">        3. Извлекает глубину покрытия (DP) из поля INFO</span>
<span class="sd">        4. Агрегирует статистику по регионам</span>

<span class="sd">        Входные данные:</span>
<span class="sd">        - region_size: целое число, размер региона в базовых парах (по умолчанию 1000)</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - DataFrame с колонками CHROM, REGION, TOTAL_DEPTH, VARIANT_COUNT</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">varlines</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Внутренний генератор для строк вариантов.&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">x</span>

        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">varlines</span><span class="p">():</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">chrom</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">dp</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;DP=&#39;</span><span class="p">):</span>
                    <span class="n">dp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
                    <span class="k">break</span>

            <span class="n">region_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">//</span> <span class="n">region_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">region_size</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">chrom</span><span class="p">,</span> <span class="n">region_start</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TOTAL_DEPTH&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;VARIANT_COUNT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
            <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;TOTAL_DEPTH&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dp</span>
            <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;VARIANT_COUNT&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">([</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;TOTAL_DEPTH&#39;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;VARIANT_COUNT&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CHROM&#39;</span><span class="p">,</span> <span class="s1">&#39;REGION&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTAL_DEPTH&#39;</span><span class="p">,</span> <span class="s1">&#39;VARIANT_COUNT&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="Vcf_reader.varregion">
<a class="viewcode-back" href="../../code_scripts_package.html#code_scripts.vcf_reader3.Vcf_reader.varregion">[документация]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">varregion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ПОИСК ВАРИАНТОВ В ЗАДАННОМ ГЕНОМНОМ РЕГИОНЕ</span>
<span class="sd">        ===========================================</span>
<span class="sd">        Находит все варианты в указанном геномном интервале.</span>

<span class="sd">        Логика работы:</span>
<span class="sd">        1. Фильтрует строки вариантов, исключая заголовки</span>
<span class="sd">        2. Проверяет принадлежность варианта к целевой хромосоме</span>
<span class="sd">        3. Проверяет попадание позиции варианта в заданный интервал [start, end]</span>
<span class="sd">        4. Собирает информацию о подходящих вариантах</span>

<span class="sd">        Входные данные:</span>
<span class="sd">        - chrom: строка, название хромосомы (например, &#39;chr1&#39;)</span>
<span class="sd">        - start: целое число, начальная позиция региона</span>
<span class="sd">        - end: целое число, конечная позиция региона</span>

<span class="sd">        Выходные данные:</span>
<span class="sd">        - list: список списков, где каждый внутренний список содержит поля варианта</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">gen</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Внутренний генератор для фильтрации вариантов.&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">x_chrom</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">x_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">x_chrom</span> <span class="o">==</span> <span class="n">chrom</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">x_pos</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">columns</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">gen</span><span class="p">())</span></div>
</div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Infa_project</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Искать" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Навигация</h3>
<p class="caption" role="heading"><span class="caption-text">Содержание</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Модули</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../main.html">Скрипт main</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Код модуля</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Anastas.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>